## apVisitproc

This proto-package assumes you, the user, have some apVisit spectra from
APOGEE and would like to turn them into text files that are continuum normalized 
and free of "spikey" telluric artifacts.


*apVisit2input.py* takes a data directory `datadir` and a KIC (targetID).
It looks for a text file named `datadir/KIC/KICVisitinfo.txt` which you must
create for your target.

To create this file, use the interface at <https://dr13.sdss.org/infrared/spectrum/view/visits>
to retrieve a list of apVisit spectra. Save the CSV as the KICVisitinfo.txt file described above.

For example, if your target's KIC is 9246715 and APOGEE ID is 2M20034832+4536148,
search for the APOGEE ID with the web app, scroll down and select the "Visits" tab,
and click the button to download the Table (csv) of the visit metadata.
Rename/move this file to `datadir/9246715/9246715Visitinfo.txt`.
Then, run apVisit2input like this

`$ python apVisit2input.py -d datadir -k 9246715`

The output is one text file for each visit spectrum.
The full path to each file is printed to the screen, along with each visit's time
of observation in days (HJD) and barycentric velocity in km/s (BCV).


*despike.py* takes either the text files generated by apVisit2input.py *or* a set
of regular old apVisit FITS files (in case you downloaded them individually yourself
and did not use apVisit2input.py). You must tell the program which files to despike 
by creating a text file referred to as `infilelist` that lives at `datapath`.

For example, if you have just two spectra in `datadir/KIC/`, create a text file
called `infilelist` in the same directory which contains two lines

`nameofspectrum1.txt`
`nameofspectrum2.txt`

(do not include the full paths to the spectra, just their filenames).
Then, run despike.py like this

`$ python despike.py -d datadir/KIC -i infilelist`

The output is a series of plots showing what the despike routine is doing.
Close each plot to let the program proceed. When it is finished, you will have
a new set of text file spectra in `datapath` that end in `_despiked.txt`.
